<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wissenaire'22 | Profile</title>
    <link rel="icon" type="image/x-icon" href="./assets/img/blue_favicon.ico">
    <link
      href="https://fonts.googleapis.com/css?family=Exo+2:600,700,800,900"
      rel="stylesheet"
      type="text/css"
    />

    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.0.6/css/all.css"
    />
    
    <!-- alerts -->
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/boxicons@2.0.7/dist/boxicons.min.js"></script>
    <!-- ajax -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
    
    <!-- preloader -->
    <link href="assets/css/style.css" rel="stylesheet" />

    <style>
      body {
        margin: 0;
        background-color: #121212;
      }
      .globeViz {
        position: absolute;
        display: inline;
        z-index: -1;
        top: 0;
        left: 0;
      }

      .top-layer {
        position: absolute;
        width: 100%;
        z-index: 1;
        top: 6vh;
        left: 0;
      }

      .cur {
        height: 31px;
        width: 31px;
        z-index: 99999999;
        pointer-events: none;
        /* background: grey;*/
        border-radius: 50%;
        position: absolute;
        /*animation: cursorAnim .5s infinite alternate;*/
        animation: rotate 4s infinite linear;
        transition: all 0.3s ease;
        transition-property: background, transform;
        transform-origin: 100%, 100%;
      }


      .main-cur {
        animation: none;
        margin: 0px;
        content: "";
        width: 0.1px;
        height: 0.1px;
        border: 10.5px solid#1A28CF;
        position: absolute;
        border-radius: 50%;
        /* opacity: .5; */
        top: 4.5px;
        left: 4.5px;
        /* transform: translate(-50%, -50%); */
        animation: cursorAnim 0.5s infinite alternate;
      }

      .satelite {
        height: 30px;
        margin: 30px;
        transform: rotate(-1deg);
        /* transition-duration: 200ms;
    transition-timing-function: ease-out;
    */
      }

      @keyframes rotate {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(359deg);
        }
      }

      @keyframes cursorAnim {
        from {
          transform: scale(1);
        }
        to {
          transform: scale(0.7);
        }
      }

      @keyframes cursorClick {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(2);
        }
        100% {
          transform: scale(1);
          opacity: 0;
        }
      }

      .expand {
        animation: cursorClick 0.5s forwards;
        border: 1px solid blue;
      }

      .link-grow {
        transform: scale(2);
        background: #1a28cf;
      }

    </style>

    <!-- <link rel="stylesheet" href="./css/css1.css"> -->
    <link rel="stylesheet" href="./css/css2.css" />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.0.6/css/all.css"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Abril+Fatface"
    />
    <link rel="stylesheet" href="./css/hover-min.css" />
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />

    <link rel="stylesheet" href="./css/profile.css" />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
  </head>

  <body>
    <%- include('partials/navbar')%>
    
    <div class="top-layer">
      <div class="container">
        <div class="cardWrapper">
          <div class="card outer-div">
            <div class="inner-div">
              <div class="front">
                <div class="front__bkg-photo"></div>
                <div class="front__face-photo"
                >
                
                <script>
                    let photo = '<%=participant.photo%>';
                    document.querySelector('.front__face-photo').style.backgroundImage = `url(${photo})`;
                </script>
                </div>
                <div class="front__text">
                  <h3 class="front__text-header"><%=participant.name%></h3>
                  
                  <p class="front__text-para">
                    <i class="far fa-envelope front-icons"></i
                    ><%=participant.email%>
                  </p>
                  <%if(participant.wissId) {%>
                    <b><p class="front__text-para"><%=participant.wissId%></p></b>
                  <%}%>
                  <div class = "profile_buttons">
                    <a href="/logout"><i class="fas fa-sign-out-alt"></i></i></a>
                    <a href="/"><i class="fas fa-home"></i></a>
                    <a href="/workshops"><i class="fas fa-chalkboard-teacher"></i></a>
                    <a href="/competitions"><i class="fas fa-code"></i></a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <%if(participant.phoneNumber){%>
          <div class="cardWrapper">
            <div class="formContainer">
              <div class="title">User Profile</div>
              <div class="content">
                
                  <form action="#">
                    
                    <div class="user-details">
                      <div class="input-box">
                        <span class="details">Phone Number</span>
                        <input
                          type="text"
                          placeholder=<%=participant.phoneNumber%>
                          disabled
                          name = "phoneNumber"
                        />
                      </div>
                      <div class="input-box">
                        <span class="details">Institute</span>
                        <input
                          type="text"
                          placeholder=<%=participant.institute%>
                          disabled
                          name = "institute"
                        />
                      </div>
                      <div class="input-box">
                        <span class="details">Branch</span>
                        <input
                          type="text"
                          placeholder=<%=participant.branch%>
                          disabled
                          name = "branch"
                        />
                      </div>
                      <div class="input-box">
                        <span class="details">Year</span>
                        <input type="text" placeholder= <%=participant.year%> name = "year" disabled />
                      </div>
                      <div class="input-box">
                        <span class="details">City</span>
                        <input type="text" placeholder= <%=participant.city%> name = "city" disabled />
                      </div>
                      <%if(participant.caref) {%>
                      <div class="input-box">
                        <span class="details">Reference ID of CA (if any)</span>
                        <input type="text" placeholder=<%=participant.caref%> name="caref" disabled />
                      </div>
                      <%}%>
                    </div>
                  </form>
              </div>
            </div>
          </div>
        <%} else {%>
          <div class="cardWrapper">
            <div class="formContainer">
              <div class="title">Update Profile</div>
              <div class="content">
                  <form action="#">
                    <div class="user-details">
                      <div class="input-box">
                        <span class="details">Phone Number</span>
                        <input
                          type="text"
                          placeholder="Enter your phone number"
                          required
                          name = "phoneNumber"
                        />
                      </div>
                      <div class="input-box">
                        <span class="details">Institute</span>
                        <input
                          type="text"
                          placeholder="Eg: IIT Bhubaneswar"
                          required
                          name = "institute"
                        />
                      </div>
                      <div class="input-box">
                        <span class="details">Branch</span>
                        <input
                          type="text"
                          placeholder="Eg: Computer Science"
                          required
                          name = "branch"
                        />
                      </div>
                      <div class="input-box">
                        <span class="details">Year</span>
                        <input type="text" placeholder="Eg: 3rd year" name = "year" required />
                      </div>
                      <div class="input-box">
                        <span class="details">City</span>
                        <input type="text" placeholder="Eg: Bhubaneswar" name = "city" required />
                      </div>
                      <div class="input-box">
                        <span class="details">Reference ID of CA (if any)</span>
                        <input type="text" placeholder="Eg: W22001" name="caref" />
                      </div>
                    </div>

                    <div class="button">
                      <input type="submit" value="Submit" />
                    </div>
                  </form>
              </div>
            </div>
        </div>
        <%}%>
        <script>
          $("form").submit(function(e) {
            e.preventDefault(); 
            var form = $(this);
            console.log('ok');
            $.ajax({
                type: "POST",
                url: '/updateProfile',
                data: form.serialize(), 
                success: function(result)
                {
                    if(result){
                            new swal({
                                title: 'Success',
                                text: 'Welcome to Wissenaire family !',
                                icon: 'success'
                            }).then(flag => {
                              if(flag) {
                                window.location.href='/profile';
                              }
                            });
                        }
                        else{
                            new swal({
                                title: 'Error',
                                text: 'Please try again',
                                icon: 'error'
                            });
                      }
                }
                });
            });
      </script>
      </div>
    </div>
    <div class="cur" id="circle">
      <div class="main-cur"></div>
      <img class="satelite" src="./Satellite.svg" alt="" />
    </div>

    <script src="./js/js1.js"></script>
    <script src="./js/js2.js"></script>
    <script src="./js/js3.js"></script>
    <script src="./js/js4.js"></script>
    <script src="./js/js5.js"></script>
    <script src="./js/js6.js"></script>
    <script>
      let links = document.querySelector(".main-content a");
      const cursors = document.querySelector(".cur");
      document.addEventListener("mousemove", (e) => {
        let x = e.pageX;
        let y = e.pageY;
        cursors.setAttribute(
          "style",
          "top: " + (e.pageY - 10) + "px; left: " + (e.pageX - 10) + "px;"
        );
      });

      document.addEventListener("click", () => {
        cursors.classList.add("expand");
        setTimeout(() => {
          cursors.classList.remove("expand");
        }, 500);
      });
    </script>
    <script>
      window.addEventListener("load", () => {
        AOS.init({
          duration: 1000,
          easing: "ease-in-out",
          once: true,
          mirror: false,
        });
      });
    </script>
    <!-- <script src="./javascripts/jquery.min.js"></script> -->
    <!-- js1.js is also jquery -->
    <div id="preloader"></div>
    <!-- preloader -->
    <script src="assets/js/main.js"></script>
  </body>
</html>
